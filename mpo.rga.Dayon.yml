app-id: mpo.rga.Dayon
runtime: org.gnome.Platform
runtime-version: '42'
sdk: org.gnome.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.openjdk11
command: dayon_assistant.sh
finish-args:
  - --share=ipc
  - --socket=x11
  - --share=network
  - --device=dri
  - --filesystem=home:rw
modules:
  - name: openjdk
    buildsystem: simple
    build-commands:
      - /usr/lib/sdk/openjdk11/install.sh
  - name: dayon
    buildsystem: simple
    build-commands:
      - tar -xf dayon.tgz
      - install dayon/dayon.jar /app
      - install dayon/dayon_*.sh /app
      - install -Dm755 dayon.sh -t /app/bin
      - install dayon.browser /app
      - install -d /app/share/icons/hicolor/128x128/apps
      - install -Dm644 dayon/dayon.png /app/share/icons/hicolor/128x128/apps/mpo.rga.Dayon.png
      - install -Dm644 dayon.assisted.desktop /app/share/applications/mpo.rga.Dayon.assisted.desktop
      - desktop-file-edit --remove-key=Exec /app/share/applications/mpo.rga.Dayon.assisted.desktop
      - desktop-file-edit --set-key=Exec --set-value='/app/dayon_assisted.sh' /app/share/applications/mpo.rga.Dayon.assisted.desktop
      - desktop-file-edit --set-icon=mpo.rga.Dayon /app/share/applications/mpo.rga.Dayon.assisted.desktop
      - install -Dm644 dayon.assistant.desktop /app/share/applications/mpo.rga.Dayon.assistant.desktop
      - desktop-file-edit --remove-key=Exec /app/share/applications/mpo.rga.Dayon.assistant.desktop
      - desktop-file-edit --set-key=Exec --set-value='/app/dayon_assistant.sh' /app/share/applications/mpo.rga.Dayon.assistant.desktop
      - desktop-file-edit --set-icon=mpo.rga.Dayon /app/share/applications/mpo.rga.Dayon.assistant.desktop
    sources:
      - type: file
        dest-filename: dayon.tgz
        only-arches:
          - x86_64
        url: https://github.com/RetGal/Dayon/releases/download/v11.0.5/dayon.11.0.5.tgz
        md5: b66651fe43bff87ffbf8bc794f1a665d
      - type: file
        dest-filename: dayon.sh
        url: https://raw.githubusercontent.com/RetGal/Dayon/master/flatpak/dayon.sh
        md5: f4fc5904f4964dbb61f0ffc1f365c157
      - type: file
        dest-filename: dayon.browser
        url: https://raw.githubusercontent.com/RetGal/Dayon/master/flatpak/dayon.browser
        md5: 6220f88a032d9bdb266a16224fcbd828
      - type: file
        dest-filename: dayon.assisted.desktop
        url: https://raw.githubusercontent.com/RetGal/Dayon/master/debian/dayon_assisted.desktop
        md5: faf4acd624ba31e9fec3d3b69f114a4a
      - type: file
        dest-filename: dayon.assistant.desktop
        url: https://raw.githubusercontent.com/RetGal/Dayon/master/debian/dayon_assistant.desktop
        md5: 44756c1a785c488c41bb0e782725b994